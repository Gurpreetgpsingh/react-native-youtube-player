{"version":3,"sources":["Controls.tsx"],"names":["React","useState","useRef","useEffect","View","StyleSheet","TouchableWithoutFeedback","Text","ActivityIndicator","PlayIcon","PauseIcon","FSIcon","ExitFSIcon","ProgressBar","sec2time","TIME_TO_HIDE_CONTROLS","play","topBar","ready","duration","currentTime","playVideo","pauseVideo","seekTo","toggleFS","fullScreen","showFullScreenButton","isSeekRequired","visible","setVisible","ref","hideControls","current","clearTimeout","setTimeout","hideAfterExecute","action","progress","styles","container","paddingHorizontal","upperView","controls","backgroundColor","footer","bottom","text","footerRight","create","absoluteFillObject","elevation","alignContent","justifyContent","alignItems","width","flexDirection","position","color","fontSize","marginRight","height"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TouchableWithoutFeedback,\n  Text,\n  ActivityIndicator\n} from \"react-native\";\nimport { PlayIcon, PauseIcon, FSIcon, ExitFSIcon } from \"./icons\";\nimport ProgressBar from \"./ProgressBar\";\nimport { sec2time } from \"./Utils\";\n\nconst TIME_TO_HIDE_CONTROLS = 2000;\n\ntype Props = {\n  isSeekRequired: Boolean,\n  play: Boolean;\n  ready: Boolean;\n  showFullScreenButton?: Boolean;\n  fullScreen: Boolean;\n  duration: number;\n  currentTime: number;\n  playVideo: () => void;\n  pauseVideo: () => void;\n  seekTo: (t: number) => void;\n  toggleFS: () => void;\n  topBar?: ({\n    play,\n    fullScreen\n  }: {\n    play?: Boolean;\n    fullScreen?: Boolean;\n  }) => React.ReactNode;\n};\n\nexport default ({\n  play,\n  topBar,\n  ready,\n  duration,\n  currentTime,\n  playVideo,\n  pauseVideo,\n  seekTo,\n  toggleFS,\n  fullScreen,\n  showFullScreenButton,\n  isSeekRequired,\n}: Props) => {\n  const [visible, setVisible] = useState(true);\n  const ref: { current: any } = useRef(0);\n  const hideControls = () => {\n    if (ref.current !== 0) clearTimeout(ref.current);\n    if (play && ready) {\n      ref.current = setTimeout(() => {\n        setVisible(false);\n      }, TIME_TO_HIDE_CONTROLS);\n    }\n  };\n  const hideAfterExecute = (action: Function) => {\n    hideControls();\n    return action;\n  };\n  useEffect(() => {\n    hideControls();\n    return () => {\n      clearTimeout(ref.current);\n    };\n  }, [play, ready]);\n  const progress =\n    currentTime !== 0 && duration !== 0 ? currentTime / duration : 0;\n\n  return (\n    <View\n      style={[styles.container, { paddingHorizontal: fullScreen ? 40 : 0 }]}\n      pointerEvents=\"auto\"\n    >\n      <TouchableWithoutFeedback\n        onPress={() => hideAfterExecute(setVisible)(true)}\n        style={styles.upperView}\n      >\n        <View style={styles.upperView} />\n      </TouchableWithoutFeedback>\n\n      {visible && (\n        <TouchableWithoutFeedback onPress={() => hideAfterExecute(() => {})()}>\n          <View\n            style={[\n              styles.controls,\n              {\n                paddingHorizontal: fullScreen ? 40 : 5,\n                backgroundColor: ready ? \"rgba(0,0,0,0.6)\" : \"#000\"\n              }\n            ]}\n          >\n            {topBar && topBar({ play, fullScreen })}\n            {!ready && <ActivityIndicator size=\"small\" color=\"#FFF\" />}\n            {ready && play && <PauseIcon onPress={pauseVideo} />}\n            {ready && !play && <PlayIcon onPress={playVideo} />}\n\n            <View style={[styles.footer, { bottom: fullScreen ? 12 : 10 }]}>\n              <Text style={styles.text}> {sec2time(currentTime)} </Text>\n              <View style={styles.footerRight}>\n                <Text style={styles.text}> {sec2time(duration)} </Text>\n                {showFullScreenButton && (\n                  <React.Fragment>\n                    {fullScreen ? (\n                      <ExitFSIcon size={16} onPress={toggleFS} />\n                    ) : (\n                      <FSIcon size={16} onPress={toggleFS} />\n                    )}\n                  </React.Fragment>\n                )}\n              </View>\n            </View>\n          </View>\n        </TouchableWithoutFeedback>\n      )}\n      {isSeekRequired &&\n        <ProgressBar\n          value={progress}\n          {...{ fullScreen, visible, seekTo, duration, pauseVideo, playVideo }}\n        />\n      }\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    ...StyleSheet.absoluteFillObject,\n\n    elevation: 999\n  },\n  upperView: {\n    ...StyleSheet.absoluteFillObject,\n    elevation: 11\n  },\n  controls: {\n    ...StyleSheet.absoluteFillObject,\n    alignContent: \"center\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"rgba(0,0,0,0.6)\"\n  },\n  footer: {\n    width: \"100%\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    position: \"absolute\"\n  },\n  text: {\n    color: \"#FFF\",\n    fontSize: 12,\n    marginRight: 0\n  },\n  footerRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  progress: {\n    width: \"100%\",\n    height: 2,\n    position: \"absolute\",\n    bottom: 0,\n    backgroundColor: \"red\"\n  }\n});\n"]}